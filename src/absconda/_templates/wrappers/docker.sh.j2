#!/bin/bash
# Auto-generated by absconda wrap
# Image: {{ image_ref }}
# Command: {{ command }}
set -euo pipefail

# Build mount arguments
MOUNTS=()
{% for mount in mounts %}
MOUNTS+=("-v" "{{ mount }}:{{ mount }}")
{% endfor %}

{% if gpu %}
# GPU support
GPU_FLAG="--gpus all"
{% else %}
GPU_FLAG=""
{% endif %}

# Execute command in container
exec docker run --rm -i \
    $GPU_FLAG \
    "${MOUNTS[@]}" \
    -w "$(pwd)" \
    {{ image_ref }} \
    {{ command }} "$@"
